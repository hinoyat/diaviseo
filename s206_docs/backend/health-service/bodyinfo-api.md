# BodyInfo API ëª…ì„¸

**Health Service ë‚´ BodyInfo ëª¨ë“ˆì€ ì²´ì„±ë¶„ ì •ë³´ ê´€ë¦¬, OCR ìë™ ì…ë ¥, ì‹ ì²´ ë³€í™” ì¶”ì ì„ ë‹´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.**

---

## ğŸ“Œ API ê°œìš”

### Base URL
```
http://health-service/api/bodies
```

### BodyInfo ëª¨ë“ˆì˜ ì—­í• 
- **ì²´ì„±ë¶„ ì •ë³´ ê´€ë¦¬**: ì²´ì¤‘, ì²´ì§€ë°©ë¥ , ê·¼ìœ¡ëŸ‰, ì‹ ì¥ ì •ë³´ CRUD
- **OCR ìë™ ì…ë ¥**: Tesseract ê¸°ë°˜ ì¸ë°”ë”” ê²°ê³¼ì§€ ìë™ ì¸ì‹
- **BMI/BMR ê³„ì‚°**: í•´ë¦¬ìŠ¤-ë² ë„¤ë”•íŠ¸ ê³µì‹ ê¸°ë°˜ ì‹ ì²´ì§€ìˆ˜ ê³„ì‚°
- **ë³€í™” ì¶”ì **: ì¼ë³„/ì£¼ë³„/ì›”ë³„ ì²´ì„±ë¶„ ë³€í™” í†µê³„
- **User Service ì—°ë™**: ì²´ì„±ë¶„ ë³€ê²½ ì‹œ ìë™ ë™ê¸°í™”

### ê³µí†µ ì‘ë‹µ í˜•ì‹
```json
{
  "timestamp": "2025-05-26T10:30:00",
  "status": "OK", 
  "message": "ì„±ê³µ ë©”ì‹œì§€",
  "data": { /* ì‹¤ì œ ë°ì´í„° */ }
}
```

### ê³µí†µ HTTP ìƒíƒœì½”ë“œ
| ìƒíƒœì½”ë“œ | ì„¤ëª… | ì‘ë‹µ ì˜ˆì‹œ |
|---------|------|----------|
| **200** | ì„±ê³µ | `"message": "ìš”ì²­ ì„±ê³µ"` |
| **201** | ìƒì„± ì„±ê³µ | `"message": "ì²´ì„±ë¶„ ë°ì´í„° ë“±ë¡ ì„±ê³µ"` |
| **400** | ì˜ëª»ëœ ìš”ì²­ | `"message": "ì²´ì¤‘ì€ ì–‘ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤."` |
| **404** | ë°ì´í„° ì—†ìŒ | `"message": "í•´ë‹¹ ë‚ ì§œì˜ ì²´ì„±ë¶„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."` |
| **408** | íƒ€ì„ì•„ì›ƒ | `"message": "ì²˜ë¦¬ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤."` |
| **500** | ì„œë²„ ì˜¤ë¥˜ | `"message": "ì„œë²„ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."` |

---

## ğŸ¥ ì²´ì„±ë¶„ ì •ë³´ ê´€ë¦¬ API

### 1. ì²´ì„±ë¶„ ì •ë³´ ë“±ë¡

#### `POST /api/bodies`

**Request Headers**
```http
X-USER-ID: {userId}
Content-Type: application/json
```

**Request Body**
```json
{
  "weight": 70.5,
  "bodyFat": 15.2,
  "muscleMass": 32.1,
  "height": 175.0,
  "measurementDate": "2025-05-26"
}
```

**ì²˜ë¦¬ ê³¼ì •**
1. **ì…ë ¥ê°’ ê²€ì¦**: ì²´ì¤‘(ì–‘ìˆ˜), ì²´ì§€ë°©ë¥ (0-100%), ê·¼ìœ¡ëŸ‰(0-1000kg) ë“±
2. **BodyInfo ì—”í‹°í‹° ìƒì„±**: inputType = MANUALë¡œ ì„¤ì •
3. **BMI/BMR ê³„ì‚°**: User Serviceì—ì„œ ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ í›„ ê³„ì‚°
4. **User Service ë™ê¸°í™”**: ì²´ì„±ë¶„ ì •ë³´ ìë™ ì „ì†¡

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T10:30:00",
  "status": "CREATED",
  "message": "ì²´ì„±ë¶„ ë°ì´í„° ë“±ë¡ ì„±ê³µ",
  "data": {
    "bodyId": 1,
    "userId": 123,
    "height": 175.0,
    "weight": 70.5,
    "bodyFat": 15.2,
    "muscleMass": 32.1,
    "measurementDate": "2025-05-26",
    "bmi": 23.02,
    "bmr": 1687.5,
    "createdAt": "2025-05-26T10:30:00"
  }
}
```

---

### 2. ì²´ì„±ë¶„ ì •ë³´ ì¡°íšŒ (ìµœì‹ )

íŠ¹ì • ë‚ ì§œ ì´ì „ì˜ ê°€ì¥ ìµœê·¼ ì²´ì„±ë¶„ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

#### `GET /api/bodies`

**Query Parameters**
| íŒŒë¼ë¯¸í„° | íƒ€ì… | í•„ìˆ˜ | ê¸°ë³¸ê°’ | ì„¤ëª… |
|---------|------|------|-------|------|
| `date` | LocalDate | âŒ | ì˜¤ëŠ˜ | ì¡°íšŒ ê¸°ì¤€ ë‚ ì§œ (YYYY-MM-DD) |

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T15:00:00",
  "status": "OK",
  "message": "ìœ ì € ì²´ì„±ë¶„ ì •ë³´ ëª©ë¡ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ë°˜í™˜ ì²˜ë¦¬ëìŠµë‹ˆë‹¤.",
  "data": [
    {
      "bodyId": 1,
      "userId": 123,
      "height": 175.0,
      "weight": 70.5,
      "bodyFat": 15.2,
      "muscleMass": 32.1,
      "measurementDate": "2025-05-26",
      "bmi": 23.02,
      "bmr": 1687.5,
      "createdAt": "2025-05-26T10:30:00"
    }
  ]
}
```

**Response (ë°ì´í„° ì—†ìŒ - ì´ˆê¸° ì‘ë‹µ)**
```json
{
  "data": [
    {
      "bodyId": null,
      "userId": 123,
      "height": 175.0,
      "weight": 70.0,
      "bodyFat": 0.0,
      "muscleMass": 0.0,
      "measurementDate": null,
      "bmi": 22.86,
      "bmr": 1650.0,
      "createdAt": null
    }
  ]
}
```

---

### 3. íŠ¹ì • ë‚ ì§œ ì²´ì„±ë¶„ ì¡°íšŒ

#### `GET /api/bodies/date`

**Query Parameters**
| íŒŒë¼ë¯¸í„° | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|---------|------|------|------|
| `date` | LocalDate | âœ… | ì¡°íšŒí•  ë‚ ì§œ (YYYY-MM-DD) |

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T16:00:00",
  "status": "OK",
  "message": "ìœ ì € ì²´ì„±ë¶„ ì •ë³´ ì¡°íšŒê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ëìŠµë‹ˆë‹¤.",
  "data": {
    "bodyId": 1,
    "userId": 123,
    "height": 175.0,
    "weight": 70.5,
    "bodyFat": 15.2,
    "muscleMass": 32.1,
    "measurementDate": "2025-05-26",
    "bmi": 23.02,
    "bmr": 1687.5,
    "createdAt": "2025-05-26T10:30:00"
  }
}
```

---

### 4. ì²´ì„±ë¶„ ì •ë³´ ìˆ˜ì •

#### `PATCH /api/bodies/{bodyId}`

**Request Body**
```json
{
  "weight": 69.8,
  "bodyFat": 14.5,
  "muscleMass": 33.2,
  "height": 175.0,
  "measurementDate": "2025-05-26"
}
```

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T17:00:00",
  "status": "OK",
  "message": "ì²´ì„±ë¶„ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": {
    "bodyId": 1,
    "userId": 123,
    "height": 175.0,
    "weight": 69.8,
    "bodyFat": 14.5,
    "muscleMass": 33.2,
    "measurementDate": "2025-05-26",
    "bmi": 22.81,
    "bmr": 1675.3,
    "createdAt": "2025-05-26T10:30:00"
  }
}
```

---

### 5. ì²´ì„±ë¶„ ì •ë³´ ì‚­ì œ

#### `DELETE /api/bodies/{bodyId}`

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T18:00:00",
  "status": "OK",
  "message": "ì²´ì„±ë¶„ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
  "data": null
}
```

---

## ğŸ“· OCR ìë™ ì…ë ¥ API

### 6. OCR ë°ì´í„° ì¶”ì¶œ

ì¸ë°”ë”” ê²°ê³¼ì§€ ì´ë¯¸ì§€ì—ì„œ ì²´ì„±ë¶„ ë°ì´í„°ë¥¼ ìë™ ì¶”ì¶œí•©ë‹ˆë‹¤.

#### `POST /api/bodies/ocr` (multipart/form-data)

**Request Parameters**
```
image (File): ì¸ë°”ë”” ê²°ê³¼ì§€ ì´ë¯¸ì§€ íŒŒì¼
```

**ì²˜ë¦¬ ê³¼ì •**
1. **ì´ë¯¸ì§€ ì—…ë¡œë“œ**: MultipartFile ìˆ˜ì‹ 
2. **ë¹„ë™ê¸° OCR ì²˜ë¦¬**: Tesseract ì—”ì§„ìœ¼ë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ (30ì´ˆ íƒ€ì„ì•„ì›ƒ)
3. **ë°ì´í„° íŒŒì‹±**: ì •ê·œì‹ìœ¼ë¡œ ì²´ì¤‘, ì²´ì§€ë°©ë¥ , ê·¼ìœ¡ëŸ‰, í‚¤, ì¸¡ì •ì¼ ì¶”ì¶œ
4. **ê²°ê³¼ ë°˜í™˜**: BodyInfoCreateRequest í˜•íƒœë¡œ ë°˜í™˜

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T19:00:00",
  "status": "OK",
  "message": "OCR ì •ë³´ ì¶”ì¶œ ì„±ê³µ",
  "data": {
    "weight": 70.5,
    "bodyFat": 15.2,
    "muscleMass": 32.1,
    "height": 175.0,
    "measurementDate": "2025-05-26"
  }
}
```

**ì—ëŸ¬ ì‘ë‹µ**
| ìƒíƒœì½”ë“œ | ì—ëŸ¬ ì¼€ì´ìŠ¤ | ì‘ë‹µ ë©”ì‹œì§€ |
|---------|-----------|-----------|
| **408** | ì²˜ë¦¬ ì‹œê°„ ì´ˆê³¼ | `"ì²˜ë¦¬ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤."` |
| **400** | ì´ë¯¸ì§€ ì²˜ë¦¬ ì‹¤íŒ¨ | `"ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."` |

---

### 7. OCR ë°ì´í„° í™•ì¸ í›„ ì €ì¥

OCR ê²°ê³¼ë¥¼ í™•ì¸/ìˆ˜ì •í•œ í›„ ìµœì¢… ì €ì¥í•©ë‹ˆë‹¤.

#### `POST /api/bodies/ocr/confirm`

**Request Body**
```json
{
  "weight": 70.5,
  "bodyFat": 15.2,
  "muscleMass": 32.1,
  "height": 175.0,
  "measurementDate": "2025-05-26"
}
```

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T20:00:00",
  "status": "CREATED",
  "message": "OCR ë°ì´í„° í™•ì¸ í›„ ì²´ì„±ë¶„ ë°ì´í„° ë“±ë¡ ì„±ê³µ",
  "data": {
    "bodyId": 2,
    "userId": 123,
    "height": 175.0,
    "weight": 70.5,
    "bodyFat": 15.2,
    "muscleMass": 32.1,
    "measurementDate": "2025-05-26",
    "bmi": 23.02,
    "bmr": 1687.5,
    "createdAt": "2025-05-26T20:00:00"
  }
}
```

---

## ğŸ“Š ë³€í™” ì¶”ì  ë° í†µê³„ API

### 8. ì£¼ê°„ ì²´ì„±ë¶„ ë°ì´í„°

ìµœê·¼ 7ì¼ê°„ ì¼ë³„ ì²´ì„±ë¶„ ë³€í™”ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

#### `GET /api/bodies/weekly`

**Query Parameters**
| íŒŒë¼ë¯¸í„° | íƒ€ì… | í•„ìˆ˜ | ê¸°ë³¸ê°’ | ì„¤ëª… |
|---------|------|------|-------|------|
| `endDate` | LocalDate | âŒ | ì˜¤ëŠ˜ | ì¢…ë£Œ ë‚ ì§œ |

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T21:00:00",
  "status": "OK",
  "message": "ì£¼ê°„ ì²´ì„±ë¶„ ì •ë³´ ì¡°íšŒê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ëìŠµë‹ˆë‹¤.",
  "data": [
    {
      "measurementDate": "2025-05-20",
      "weight": 71.2,
      "muscleMass": 31.8,
      "bodyFat": 15.5,
      "height": 175.0
    },
    {
      "measurementDate": "2025-05-21",
      "weight": 0.0,
      "muscleMass": 0.0,
      "bodyFat": 0.0,
      "height": 0.0
    },
    {
      "measurementDate": "2025-05-26",
      "weight": 70.5,
      "muscleMass": 32.1,
      "bodyFat": 15.2,
      "height": 175.0
    }
  ]
}
```

---

### 9. ì£¼ë³„ í‰ê·  ì²´ì„±ë¶„

ìµœê·¼ 7ì£¼ê°„ ì£¼ë³„ í‰ê·  ì²´ì„±ë¶„ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

#### `GET /api/bodies/weekly-avg`

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T22:00:00",
  "status": "OK",
  "message": "7ì£¼ê°„ ì£¼ë³„ í‰ê·  ì²´ì„±ë¶„ ì •ë³´ ì¡°íšŒê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ëìŠµë‹ˆë‹¤.",
  "data": [
    {
      "weekLabel": 1,
      "avgWeight": 71.50,
      "avgMuscleMass": 31.20,
      "avgBodyFat": 16.10,
      "avgHeight": 175.00
    },
    {
      "weekLabel": 2,
      "avgWeight": 71.20,
      "avgMuscleMass": 31.50,
      "avgBodyFat": 15.80,
      "avgHeight": 175.00
    },
    {
      "weekLabel": 7,
      "avgWeight": 70.50,
      "avgMuscleMass": 32.10,
      "avgBodyFat": 15.20,
      "avgHeight": 175.00
    }
  ]
}
```

---

### 10. ì›”ë³„ í‰ê·  ì²´ì„±ë¶„

ìµœê·¼ 7ê°œì›”ê°„ ì›”ë³„ í‰ê·  ì²´ì„±ë¶„ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

#### `GET /api/bodies/monthly-avg`

**Response (ì„±ê³µ)**
```json
{
  "timestamp": "2025-05-26T23:00:00",
  "status": "OK",
  "message": "7ê°œì›”ê°„ ì›”ë³„ í‰ê·  ì²´ì„±ë¶„ ì •ë³´ ì¡°íšŒê°€ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ëìŠµë‹ˆë‹¤.",
  "data": [
    {
      "monthIndex": 1,
      "avgWeight": 72.80,
      "avgMuscleMass": 30.50,
      "avgBodyFat": 17.20,
      "avgHeight": 175.00
    },
    {
      "monthIndex": 7,
      "avgWeight": 70.30,
      "avgMuscleMass": 32.40,
      "avgBodyFat": 14.80,
      "avgHeight": 175.00
    }
  ]
}
```

---

## ğŸ”§ ì£¼ìš” íŠ¹ì§•

### OCR ì²˜ë¦¬ íŠ¹ì§•
- **Tesseract 4.0+ ì—”ì§„**: ê³ ì„±ëŠ¥ OCR ì²˜ë¦¬
- **ë¹„ë™ê¸° ì²˜ë¦¬**: 30ì´ˆ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´
- **ì •ê·œì‹ íŒŒì‹±**: ì²´ì¤‘, ì²´ì§€ë°©ë¥ , ê·¼ìœ¡ëŸ‰, í‚¤, ì¸¡ì •ì¼ ìë™ ì¶”ì¶œ
- **OSë³„ ìµœì í™”**: Windows/Linux í™˜ê²½ë³„ ìë™ ê²½ë¡œ ì„¤ì •

### ê³„ì‚° ê³µì‹
```
BMI = ì²´ì¤‘(kg) Ã· ì‹ ì¥(m)Â²

BMR (ë‚¨ì„±) = 88.362 + (13.397 Ã— ì²´ì¤‘) + (4.799 Ã— ì‹ ì¥) - (5.677 Ã— ë‚˜ì´)
BMR (ì—¬ì„±) = 447.593 + (9.247 Ã— ì²´ì¤‘) + (3.098 Ã— ì‹ ì¥) - (4.330 Ã— ë‚˜ì´)
```

### ë°ì´í„° ê²€ì¦
- **ì²´ì¤‘**: 0-500kg
- **ì²´ì§€ë°©ë¥ **: 0-100%
- **ê·¼ìœ¡ëŸ‰**: 0-1000kg
- **ì‹ ì¥**: 0-1000cm
- **ì¸¡ì •ì¼**: í˜„ì¬ ë˜ëŠ” ê³¼ê±° ë‚ ì§œë§Œ í—ˆìš©

### í†µê³„ ì²˜ë¦¬
- **ë¹ˆ ë°ì´í„° ì²˜ë¦¬**: ë°ì´í„°ê°€ ì—†ëŠ” ë‚ ì§œëŠ” 0ìœ¼ë¡œ ì±„ì›€
- **0ê°’ ì œì™¸ í‰ê· **: ì‹¤ì œ ì¸¡ì •ê°’ë§Œìœ¼ë¡œ í‰ê·  ê³„ì‚°
- **ì†Œìˆ˜ì  ì²˜ë¦¬**: BigDecimal ì‚¬ìš©ìœ¼ë¡œ ì •í™•í•œ ê³„ì‚°