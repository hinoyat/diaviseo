# Alert Service API ëª…ì„¸

**Alert ServiceëŠ” ì‚¬ìš©ìì—ê²Œ ìš´ë™Â·ì‹ë‹¨ ê´€ë ¨ ì •ë³´ë¥¼ í‘¸ì‹œ ì•Œë¦¼ í˜•íƒœë¡œ ì „ë‹¬í•˜ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.**

---

## ğŸ“Œ API ê°œìš”

### Base URL
```
http://alert-service/api
```

### Alert Serviceì˜ ì—­í• 
- **FCM í† í° ê´€ë¦¬**: ì‚¬ìš©ì ë””ë°”ì´ìŠ¤ì˜ Firebase Cloud Messaging í† í° ë“±ë¡ ë° ê°±ì‹ 
- **ì•Œë¦¼ ì¡°íšŒ ë° ê´€ë¦¬**: ì‚¬ìš©ìì˜ ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ ë° ì‚­ì œ
- **ì•Œë¦¼ ì „ì†¡**: MQ ê¸°ë°˜ì˜ ë¹„ë™ê¸° í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡ ì²˜ë¦¬
- **ì•Œë¦¼ ì €ì¥**: ì•Œë¦¼ ì´ë ¥ ì €ì¥ ë° ìƒíƒœ ì—…ë°ì´íŠ¸

### ê³µí†µ ì‘ë‹µ í˜•ì‹
ëª¨ë“  APIëŠ” Common Moduleì˜ `ResponseDto` í˜•ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```json
{
  "timestamp": "2025-05-28T13:00:00",
  "status": "OK", 
  "message": "ì„±ê³µ ë©”ì‹œì§€",
  "data": { /* ì‹¤ì œ ë°ì´í„° */ }
}
```

### ê³µí†µ HTTP ìƒíƒœì½”ë“œ
| ìƒíƒœì½”ë“œ | ì„¤ëª… | ì‘ë‹µ ì˜ˆì‹œ |
|---------|------|----------|
| **200** | ì„±ê³µ | `"message": "ìš”ì²­ ì„±ê³µ"` |
| **400** | ì˜ëª»ëœ ìš”ì²­ | `"message": "í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤."` |
| **401** | ì¸ì¦ ì‹¤íŒ¨ | `"message": "ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤."` |
| **500** | ì„œë²„ ì˜¤ë¥˜ | `"message": "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."` |

---

## ğŸ“² 1. FCM í† í° ë“±ë¡ API

#### `POST /api/users/fcm-token`

ì‚¬ìš©ìì˜ FCM(Firebase Cloud Messaging) í† í°ì„ ë“±ë¡í•˜ê±°ë‚˜ ê°±ì‹ í•©ë‹ˆë‹¤.

**Headers**
```http
Authorization: Bearer {accessToken}
Content-Type: application/json
```

**Body**
```json
{
  "token": "dgl42ys1csj...DeviceToken"
}
```

**Response**
```json
{
  "timestamp": "2025-05-28T13:00:00",
  "status": "OK",
  "message": "FCM í† í° ë“±ë¡ ì„±ê³µ",
  "data": null
}
```

**ì—ëŸ¬ ì‘ë‹µ**
| ìƒíƒœ ì½”ë“œ | ì—ëŸ¬ ì½”ë“œ | ì„¤ëª… |
|-----------|-----------|------|
| **400**   | BAD_REQUEST | ìš”ì²­ ë³¸ë¬¸ì´ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš° |
| **401**   | UNAUTHORIZED | ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì |
| **500**   | INTERNAL_SERVER_ERROR | ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ ë°œìƒ |

---

## ğŸ“¬ 2. ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ API

#### `GET /api/alert`

ì‚¬ìš©ìì˜ ì•Œë¦¼ ëª©ë¡ì„ í˜ì´ì§• ì²˜ë¦¬í•˜ì—¬ ì¡°íšŒí•©ë‹ˆë‹¤.

**Headers**
```http
Authorization: Bearer {accessToken}
```

**Query Parameters**

| íŒŒë¼ë¯¸í„° | íƒ€ì…     | í•„ìˆ˜ | ê¸°ë³¸ê°’       | ì„¤ëª…                         |
|----------|----------|------|--------------|------------------------------|
| `page`   | Integer  | âŒ   | `0`          | í˜ì´ì§€ ë²ˆí˜¸ (0ë¶€í„° ì‹œì‘)     |
| `size`   | Integer  | âŒ   | `20`         | í•œ í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜          |
| `sort`   | String   | âŒ   | `sentAt,desc`| ì •ë ¬ ê¸°ì¤€ (í•„ë“œ, ë°©í–¥)       |

**Response**
```json
{
  "timestamp": "2025-05-28T13:00:00",
  "status": "OK",
  "message": "ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ ì„±ê³µ",
  "data": {
    "content": [...],
    "pageable": {...},
    "totalPages": 1,
    "totalElements": 4,
    ...
  }
}
```

---

## âœ… 3. ë‹¨ê±´ ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ API

#### `PATCH /api/alert/{notificationId}/read`

íŠ¹ì • ì•Œë¦¼ì„ ì½ìŒ ì²˜ë¦¬í•©ë‹ˆë‹¤.

**Headers**
```http
Authorization: Bearer {accessToken}
```

**Path Params**
- `notificationId`: ì½ìŒ ì²˜ë¦¬í•  ì•Œë¦¼ ID

**Response**
```json
{
  "timestamp": "2025-05-15T00:48:36.604377",
  "status": "OK",
  "message": "ì½ìŒ ì²˜ë¦¬ ëìŠµë‹ˆë‹¤",
  "data": null
}
```

**ì—ëŸ¬ ì‘ë‹µ**
| ìƒíƒœ ì½”ë“œ | ë©”ì‹œì§€ | ì„¤ëª… |
|-----------|--------|------|
| **403**   | í•´ë‹¹ ì•Œë¦¼ì— ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤ | ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì•Œë¦¼ ì ‘ê·¼ |
| **404**   | ì•Œë¦¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤ | ì•Œë¦¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ |

---

## âœ… 4. ì „ì²´ ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬ API

#### `PATCH /api/alert/read-all`

ì‚¬ìš©ìì˜ ëª¨ë“  ì½ì§€ ì•Šì€ ì•Œë¦¼ì„ ì½ìŒ ì²˜ë¦¬í•©ë‹ˆë‹¤.

**Headers**
```http
Authorization: Bearer {accessToken}
```

**Response**
```json
{
  "timestamp": "2025-05-15T00:59:58.875251",
  "status": "OK",
  "message": "ì½ìŒ ì²˜ë¦¬ ëìŠµë‹ˆë‹¤",
  "data": null
}
```

---

## ğŸ—‘ï¸ 5. ë‹¨ê±´ ì•Œë¦¼ ì‚­ì œ API

#### `DELETE /api/alert/{notificationId}/delete`

íŠ¹ì • ì•Œë¦¼ì„ ì‚­ì œí•©ë‹ˆë‹¤. ì‚¬ìš©ì ë³¸ì¸ì˜ ì•Œë¦¼ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**Headers**
```http
Authorization: Bearer {accessToken}
```

**Path Params**
- `notificationId`: ì‚­ì œí•  ì•Œë¦¼ ID

**Response**
```json
{
  "timestamp": "2025-05-15T09:37:24.3718851",
  "status": "OK",
  "message": "ì•Œë¦¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤",
  "data": null
}
```

**ì—ëŸ¬ ì‘ë‹µ**
- 403 Forbidden
```json
{
  "status": "FORBIDDEN",
  "message": "ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì•Œë¦¼ì…ë‹ˆë‹¤.",
  "timestamp": "2023-08-10T14:30:45.123"
}
```

- 404 Not Found
```json
{
  "status": "NOT_FOUND",
  "message": "ì•Œë¦¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
  "timestamp": "2023-08-10T14:30:45.123"
}
```
